<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Information System</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body {
        background: radial-gradient(circle at top, #09121b, #000814 80%);
        font-family: "Poppins", sans-serif;
        color: #d7f7ff;
        padding: 22px;
    }

    /* Neon glow text */
    h2, h5, h3 { text-shadow: 0 0 8px #00fff7; }

    .glass-box {
        background: rgba(0,255,255,0.05);
        border: 1px solid rgba(0,255,255,0.35);
        backdrop-filter: blur(14px);
        border-radius: 18px;
        padding: 30px;
        box-shadow: 0 0 20px rgba(0,255,255,0.15);
        animation: fadeIn 0.7s ease-out;
    }

    #searchInput, #categoryFilter {
        background: rgba(0,255,255,0.08) !important;
        border: 1px solid rgba(0,255,255,0.35);
        color: #d7f7ff !important;
        border-radius: 14px;
        padding: 12px;
    }
    #searchInput::placeholder { color: #aeeeff; }

    .student-card {
        background: rgba(255,0,255,0.05);
        border: 1px solid rgba(255,0,255,0.45);
        box-shadow: 0 0 12px rgba(255,0,255,0.25);
        backdrop-filter: blur(12px);
        padding: 20px;
        border-radius: 14px;
        margin-bottom: 18px;
        cursor: pointer;
        transition: transform 0.25s, box-shadow 0.25s, border 0.25s;
    }

    .student-card:hover {
        transform: translateY(-6px) scale(1.02);
        border-color: #00fff7;
        box-shadow: 0 0 26px #00fff7;
    }

    .badge-category {
        background: linear-gradient(45deg, #ff00ff, #00fff7);
        color: #000;
        padding: 5px 12px;
        border-radius: 8px;
        font-weight: 600;
    }

    .modal-content {
    background: rgba(0,0,0,0.75);
    border: 1px solid #ff005d;              /* Neon Red Border */
    box-shadow: 0 0 40px #ff005d;           /* Outer Glow */
    border-radius: 18px;
    color: #ffd7e6;                         /* Slight soft red text tone */
}


    a { color: #00fff7; text-decoration: none; }
    a:hover { text-shadow: 0 0 10px #00fff7; }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(8px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
</head>

<body>

<div class="container">

    <div class="glass-box mb-4 text-center">
        <h2 class="fw-bold">ðŸŽ“ Student Information System</h2>
        <p class="opacity-75">Made By Sam | CSE Batch 2022</p>

        <div class="row mt-4 g-3">
            <div class="col-md-8">
                <input type="text" id="searchInput" class="form-control" placeholder="Search student...">
            </div>
            <div class="col-md-4">
                <select id="categoryFilter" class="form-select">
                    <option value="ALL">All Categories</option>
                    <option value="GENERAL">General</option>
                    <option value="OBC">OBC</option>
                    <option value="SC">SC</option>
                    <option value="ST">ST</option>
                </select>
            </div>
        </div>

        <p class="mt-3"><span id="resultCount">0</span> students found</p>
    </div>

    <div id="studentsContainer"></div>
</div>

<!-- Modal -->
<div class="modal fade" id="studentModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content p-4">
            <div class="modal-header border-0">
                <h5 class="modal-title">Student Profile</h5>
                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="modalContent"></div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
let allStudents = [];
const modal = new bootstrap.Modal(document.getElementById("studentModal"));

async function loadStudents() {
    const search = document.getElementById("searchInput").value;
    const category = document.getElementById("categoryFilter").value;

    const res = await fetch(`/api/students?search=${search}&category=${category}`);
    const data = await res.json();

    allStudents = data.students;
    document.getElementById("resultCount").innerText = data.total;
    renderStudents(data.students);
}

function renderStudents(students) {
    const c = document.getElementById("studentsContainer");
    if (!students.length) return c.innerHTML = `<div class="text-center opacity-75 p-3">No students found</div>`;

    c.innerHTML = students.map(s => `
        <div class="student-card" onclick="showStudent('${s.htno}')">
            <h5>${s.name}</h5>
            <p class="opacity-75">${s.rollno} â€¢ ${s.htno}</p>
            <small>ðŸ“§ ${s.email}</small><br>
            <small>ðŸ“± ${s.student_mobile}</small>
            <div class="text-end mt-2">
                <span class="badge-category">${s.category}</span>
            </div>
        </div>
    `).join("");
}

async function showStudent(htno) {
    const res = await fetch(`/api/student/${htno}`);
    const s = await res.json();

    document.getElementById("modalContent").innerHTML = `
        <h3>${s.name}</h3><hr>
        <p><strong>Roll No:</strong> ${s.rollno}</p>
        <p><strong>Admission No:</strong> ${s.admno}</p>
        <p><strong>Category:</strong> ${s.category}</p>
        <p><strong>DOB:</strong> ${s.dob}</p>
        <p><strong>Father:</strong> ${s.father}</p>
        <p><strong>Parent Mobile:</strong> <a href="tel:${s.parent_mobile}">${s.parent_mobile}</a></p>
        <p><strong>Student Mobile:</strong> <a href="tel:${s.student_mobile}">${s.student_mobile}</a></p>
        <p><strong>Email:</strong> <a href="mailto:${s.email}">${s.email}</a></p>
    `;
    modal.show();
}

document.getElementById("searchInput").addEventListener("input", loadStudents);
document.getElementById("categoryFilter").addEventListener("change", loadStudents);

loadStudents();
</script>

</body>
</html>
